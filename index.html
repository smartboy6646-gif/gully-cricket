<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Stickman Penalty Tournament</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;background:#0b2e13;color:#fff;font-family:Arial;text-align:center}
canvas{background:#1f7a3a;display:block;margin:auto}
#ui{padding:8px;font-size:14px;min-height:40px}
button{margin:4px;padding:6px 10px;border:0;border-radius:4px;cursor:pointer}
</style>
</head>
<body>

<h3>‚öΩ Stickman Penalty Tournament</h3>
<div id="ui"></div>
<canvas id="game" width="360" height="520"></canvas>

<script>
const c=document.getElementById("game"),ctx=c.getContext("2d"),ui=document.getElementById("ui");

const TEAMS=[
"Brazil","Argentina","France","Germany","Spain","Portugal","England","Italy",
"Netherlands","Belgium","Croatia","Uruguay","Mexico","USA","Japan","Korea",
"Senegal","Morocco","Nigeria","Ghana","Cameroon","Egypt","Iran","Saudi",
"Australia","Denmark","Poland","Serbia","Switzerland","Sweden","Chile","Colombia"
];

const ROUNDS={32:"Round of 32",16:"Round of 16",8:"Quarter Final",4:"Semi Final",2:"Final"};

function shuffle(arr){
for(let i=arr.length-1;i>0;i--){
let j=Math.floor(Math.random()*(i+1));
[arr[i],arr[j]]=[arr[j],arr[i]];
}
return arr;
}

let teamColors={};
TEAMS.forEach(t=>teamColors[t]=`hsl(${Math.random()*360},80%,60%)`);

let roundTeams=[],nextRound=[];
let matchIndex=0,matchNo=1;
let scoreA=0,scoreB=0,kick=0;
let sudden=false,state="select";

let ball={x:180,y:360,vx:0,vy:0,move:false,target:0};
let keeper={x:180,dir:0};

function ground(){
ctx.fillStyle="#1f7a3a";ctx.fillRect(0,0,c.width,c.height);
ctx.strokeStyle="#fff";ctx.lineWidth=2;
ctx.strokeRect(70,70,220,120);
ctx.strokeRect(120,70,120,60);
ctx.strokeRect(130,80,100,40);
ctx.beginPath();ctx.arc(180,360,4,0,Math.PI*2);ctx.fill();
}

function stickman(x,y,col,kickLeg=false){
ctx.strokeStyle=col;ctx.lineWidth=3;
ctx.beginPath();
ctx.arc(x,y-18,9,0,Math.PI*2);
ctx.moveTo(x,y-9);ctx.lineTo(x,y+24);
ctx.moveTo(x,y+2);ctx.lineTo(x-12,y+14);
ctx.moveTo(x,y+2);ctx.lineTo(x+12,y+14);
if(kickLeg){
ctx.moveTo(x,y+24);ctx.lineTo(x+18,y+34);
}else{
ctx.moveTo(x,y+24);ctx.lineTo(x-10,y+38);
ctx.moveTo(x,y+24);ctx.lineTo(x+10,y+38);
}
ctx.stroke();
}

function goalkeeper(){
ctx.strokeStyle="#ff0";ctx.lineWidth=3;
ctx.beginPath();
ctx.arc(keeper.x,110,9,0,Math.PI*2);
ctx.moveTo(keeper.x,119);ctx.lineTo(keeper.x,145);
ctx.stroke();
}

function drawBall(){
ctx.fillStyle="#fff";
ctx.beginPath();ctx.arc(ball.x,ball.y,6,0,Math.PI*2);ctx.fill();
}

function shoot(){
ball.move=true;
ball.target=[150,180,210][Math.floor(Math.random()*3)];
keeper.dir=Math.floor(Math.random()*3)-1;
ball.vx=(ball.target-180)/15;
ball.vy=-7;
}

function resolveShot(){
let saved = Math.abs(ball.target-keeper.x)<15;
if(!saved){
if(kick%2===0)scoreA++; else scoreB++;
}
kick++;
ball.move=false;
ball.x=180;ball.y=360;
keeper.x=180;

if(kick>=10 && scoreA!==scoreB) return endMatch();
if(kick>=10 && scoreA===scoreB) sudden=true;
if(sudden && scoreA!==scoreB) return endMatch();
}

function endMatch(){
let A=roundTeams[matchIndex],B=roundTeams[matchIndex+1];
let winner=scoreA>scoreB?A:B;
nextRound.push(winner);
state="result";
setTimeout(()=>{
matchIndex+=2;matchNo++;
if(matchIndex>=roundTeams.length){
roundTeams=[...nextRound];
nextRound=[];
matchIndex=0;
}
if(roundTeams.length===1){
ui.innerHTML=`üèÜ WINNER: <b>${roundTeams[0]}</b>`;
state="end";
}else startMatch();
},2000);
}

function startMatch(){
scoreA=0;scoreB=0;kick=0;sudden=false;
state="play";
}

function draw(){
ctx.clearRect(0,0,c.width,c.height);

if(state==="select"){
ui.innerHTML="<b>Select Team</b><br>";
shuffle([...TEAMS]).forEach(t=>{
let b=document.createElement("button");
b.textContent=t;b.style.background=teamColors[t];
b.onclick=()=>{
roundTeams=shuffle([...TEAMS]);
startMatch();
};
ui.appendChild(b);
});
state="wait";
}

if(state==="play"){
let A=roundTeams[matchIndex],B=roundTeams[matchIndex+1];
ui.innerHTML=`${ROUNDS[roundTeams.length]} | Match ${matchNo}<br>
<span style="color:${teamColors[A]}">${A}</span> ${scoreA} - ${scoreB}
<span style="color:${teamColors[B]}">${B}</span>`;

ground();
stickman(180,390,teamColors[A],kick%2===0);
goalkeeper();

if(ball.move){
ball.x+=ball.vx;ball.y+=ball.vy;
keeper.x+=keeper.dir*2;
if(ball.y<110) resolveShot();
}else if(Math.random()>0.97){
shoot();
}
drawBall();
}

requestAnimationFrame(draw);
}

draw();
</script>
</body>
</html>
